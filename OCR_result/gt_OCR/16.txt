12xiaoyulibozhangjingliaoandpedrovsandermakingstrongassumptionsaboutthedeformationsofthedocumentrestrictstheirgeneralitymultiviewmethodstrytoavoidspecifichardwareandassumptionsonthedistortiontypeskooetal2009tsoiandbrown2007youetal2018howevermultipleimagesareunavailableinmanysituationsinadditionto3dreconstructionmethods2dimageprocessingmethodsthatextractlowlevelfeaturesfromcontentelementstoestimatethewarpingareusuallyabletorectifytheimagesfromasingleviewthesefeaturescouldbetextlinesmischkeandluther2005wuandagam20022dboundarybrownandtsoi2006andcharactersegmentationzandifar2007recentlyconvolutionalneuralnetworkscnnshavealsobeenusedtounwrapthedistorteddocumentsdasetal2017maetal2018howeverdasetal2017onlyfocusonfourfolddocumentandmaetal2018learntheglobalmappingdirectlywhichcanbechallengingforimageswithmultiplecomplexfoldsmoreimportantlytheseworksonlyfocusongeometricrectificationandthenonuniformilluminationremainswhichmaysignificantlyaffectreadabilitymethodoverviewtoaddresstheselimitationsthispaperproposesapatchbasedlearningmethodthatcanrectifydocumentimageswithvariousdistortiontypesfromasingleinputimageweprovideapracticalsolutionforprinteddocumentswithmoderatecurvesandfoldsourintuitionisthatthedistortionoftheentiredocumentimagecanbespatiallyvaryingandmuchmorecomplextolearnthanthelocalpatchdistortionfigure2showsanoverviewofoursystemgivenaninputimagewestartbypartitioningtheimageinaregulargridofimagepatcheswith25overlapineachdimensionwethenfeedeachofthepatchesintoourtrainednetworkwhichoutputsthelocaldistortionflowsection3theflowisthe2ddisplacementvectorfieldshowingthemappingbetweenthedistortedimageandthecorrespondingcorrectedimagethenequippedwiththeflowsweproposeamethodtostitchthepatchestogetherthatminimizesdistortionandresampleasingledocumentimagesection4therectifiedimagesofarstillsuffersfromsamplingandshadingissuesduetogeometricrectificationandcomplexlightingconditionsthereforewetrainanothernetworktosolvetheseproblemsthissignificantlyimprovesthevisualqualityandocraccuracysection5resultsindicatethatusingasmalldatasetof1000imagesofhighresolutionthispatchbasedmethodcanoutperformlearningdirectlyfromanimagedatasetofasmanyas100kimagesmaetal2018overallourmethodcanbeappliedtoabroadrangeofdistortedimageswhilegeneratinghighqualityresultsasshowninfigure1insummaryourmajorcontributionsare1thefirstpatchbasedlearningapproachforimagerectificationweshowthatbypartitioningtheimageswecanimprovetheresultsofpriorlearningmethodsespeciallywhenthedocumentsuffersfromseveredocumentdeformation2astitchingmethodthatconsidersthepatchflowinthegradientdomainsoastointegratetheimagepatchesachievingmoreaccuraterectificationresults3anilluminationcorrectionnetworkthatsimultaneouslyaddressesnonuniformsamplingandilluminationartifactswhilepreservingthecolorinformationfromtherectifiedimage4anewrealisticdistortedimagedatasetusedfortrainingunlikepreviousmethodsbasedon2dwarpingthedatasetgenerationinvolvessurfacemodelingtexturinglightingandexposurerenderingwehopethatthisdatasetwillbeusefulforfuturebenchmarksandotherrelateddocumentprocessingtasks2relatedworkdocumentimagerectificationhasbeenstudiedinbothcomputervisionanddocumentprocessingcommunitiesmanytechniqueshavebeenproposedtoaddressdocumentdistortionswecategorizethemintotwogroupsbasedonwhethera3dshapeisreconstructedforrectificationalsodocumentimagesusuallysufferfromdifferentdefectssuchasnoisybackgrounddamagedcharactersbleedthroughandunevenbackgroundilluminationinthispaperwemainlyfocusonunevenbackgroundilluminationwhichoftenexistsinthedocumentandinfluencesthefinalvisualqualityandocraccuracygreatlystainingordeteriorateddocumentswhichinvolvesomerestorationalgorithmsarebeyondthescopeofthispaper3dshapereconstructionspecialequipmentorpriorinformationisusuallyneededtoreconstructthe3dshapeofthedocumentimagefollowedbyflatteningthesurfacetocorrectthedistortionsbrownandseales2001acquirea3dmodelwithalightprojectorsystemzhangetal2008useadedicatedlaserrangescannertocapturethe3dstructureofthewarpeddocumentandintroducephysicalpropertiesofpaperforshaperecoverymengetal2014proposeanactivemethodusingtwostructuredbeamstorecovertwospatialcurvesofthepagesurfaceinadditiontoauxiliaryhardwaresomemethodsrelyonmultiviewimagesfor3dshapereconstructionkooetal2009tsoiandbrown2007ulgesetal2004yamashitaetal2004twoormoreimagesfromdifferentviewsareusedtodeterminethe3dshaperecentlyyouetal2018proposearidgeaware3dreconstructionmethodfrommultiimagestocorrectawidevarietyofdocumentdistortionsontheotherhandtechniquesofthesecondsubcategoryreconstructthe3dshapefromasingleviewshapefromshadinghasbeenusedtocomputethedocumentshapecourteilleetal2007tanetal2006wadaetal1997zhangetal2009otherinformationsuchasboundaryheetal2013textureflowliangetal2008textlineskiletal2017kimetal2015orvectorfieldsgaofengetal2018arealsousedtoreconstructthesurfacefromsingleimagesmanyoftheseworksassumeastrongshapemodelasthepriorinformationlikeageneralcylindricalmodelcaoetal2003piecewisecylinderzhangetal2004oradevelopablesurfacemodelliangetal20052008moreovertianandnarasimhan2011measureselfsimilarityfortextlinetracingandestimatetextorientationwithinalocalpatchintheirworkthewarpingflowisestimatedfortheentireimageincomparisonwearethefirstmethodtoestimatethepatchflowsindividuallyandthenstitchtheminthegradientdomain2dimageprocessingunlikeabove3dreconstructionmethodsimageprocessingmethodsextractlowlevelfeaturesfromcontentelementstomodelthedistortionsandareusuallyabletorectifytheimagesfromasingleviewthemajorityofthesetechniquesarebased